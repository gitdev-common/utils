window.launchReverseDCF=function(){if("www.screener.in"!==window.location.hostname)return void alert("This feature only works with https://www.screener.in/");if(document.getElementById("myBookmarkletPopup"))return;const e=document.createElement("div");e.id="myBookmarkletPopup",e.style="\n    position:fixed;\n    top:20px;\n    right:20px;\n    z-index:99999;\n    background:#fff;\n    border:1px solid #ccc;\n    padding:10px;\n    border-radius:8px;\n    box-shadow:0 2px 10px rgba(0,0,0,0.2)\n  ";let t="",n="",l=18,o=15,r=20;function c(e){if("P/E"===e){const e=document.getElementById("excludeOtherIncomeCheckbox")?.checked,l=Array.from(document.querySelectorAll("#profit-loss table.data-table tbody tr")),o=l.find((e=>e.cells[0].innerText.includes("Net Profit"))),r=l.find((e=>e.cells[0].innerText.includes("Other Income")));let c=parseFloat(o?.querySelectorAll("td:last-child")[0]?.innerText?.replaceAll(",","")||"0");const i=parseFloat(r?.querySelectorAll("td:last-child")[0]?.innerText?.replaceAll(",","")||"0");n=(e?c-i:c).toString(),t=document.querySelector("#top-ratios li")?.getElementsByClassName("value")[0]?.getElementsByClassName("number")[0]?.innerText?.replaceAll(",","")}else if("P/BV"===e)t=document.querySelectorAll("#top-ratios li")[1]?.getElementsByClassName("value")[0]?.getElementsByClassName("number")[0]?.innerText?.replaceAll(",",""),n=document.querySelectorAll("#top-ratios li")[4]?.getElementsByClassName("value")[0]?.getElementsByClassName("number")[0]?.innerText?.replaceAll(",",""),l=4,o=4,r=5;else if("EV/EBITDA"===e){const e=document.querySelectorAll("#top-ratios li");let c=!1;for(let n=0;n<=e.length;++n){const e=document.querySelectorAll("#top-ratios li")[n];if("Enterprise Value"===e?.getElementsByClassName("name")?.[0]?.innerText){t=e?.getElementsByClassName("value")?.[0]?.innerText?.match(/[\d,]+/)[0].replace(/,/g,""),c=!0;break}}if(!c||null==t)return void alert('Please add "Enterprise value" quick ratio');n=Array.from(document.querySelectorAll("#profit-loss table.data-table tbody tr")).find((e=>e.cells[0].innerText.includes("Operating Profit")))?.querySelectorAll("td:last-child")[0]?.innerText?.replaceAll(",",""),l=15,o=15,r=18}d(),function(){const e=`mc=${t}&e=${n}&dr=25&m1=${l}&m2=${o}&m3=${r}&d3=3`,c="calc_encryption_key_13624";if(e&&c&&window.CryptoJS){const t=CryptoJS.RC4.encrypt(e,c).toString(),n=`https://calc-fin.netlify.app/#/calculator/reverse-dcf?calcId=${encodeURIComponent(t)}`;window.open(n)}else console.error("Text and key are required, or CryptoJS not loaded!")}()}["P/E","P/BV","EV/EBITDA"].forEach((t=>{const n=document.createElement("button");n.textContent=t,n.style="margin:5px;padding:6px 10px;cursor:pointer;",n.onclick=()=>c(t),e.appendChild(n)}));const i=document.createElement("button");i.textContent="Ã—",i.style="\n    top:2px;\n    right:5px;\n    background:none;\n    border:none;\n    font-size:16px;\n    cursor:pointer;\n    color:#888;\n    transform: scale(1.4)\n  ",i.onclick=()=>d(),e.appendChild(i);const a=document.createElement("div");function s(t){e.contains(t.target)||d()}function d(){document.removeEventListener("click",s,!0),e.remove()}if(a.style="display:block;margin-top:10px;font-size:14px;padding-left: 8px;",a.innerHTML='\n    <input type="checkbox" id="excludeOtherIncomeCheckbox" style="margin-right:5px; transform: scale(1.3)" />\n    Exclude other income\n  ',e.appendChild(a),document.body.appendChild(e),setTimeout((()=>{document.addEventListener("click",s,!0)}),0),"undefined"==typeof CryptoJS){const e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js",document.head.appendChild(e)}};
