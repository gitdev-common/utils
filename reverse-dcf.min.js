window.launchReverseDCF=function(){if(document.getElementById("myBookmarkletPopup"))return;let e=document.createElement("div");e.id="myBookmarkletPopup",e.style=`
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 99999;
    background: #fff;
    border: 1px solid #ccc;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  `;let t="",l="",r=18,n=15,o=20;["P/E","P/BV","EV/EBITDA"].forEach(a=>{let i=document.createElement("button");i.textContent=a,i.style="margin:5px;padding:6px 10px;cursor:pointer;",i.onclick=()=>(function e(a){if("P/E"===a)l=Array.from(document.querySelectorAll("#profit-loss table.data-table tbody tr")).find(e=>e.cells[0].innerText.includes("Net Profit"))?.querySelectorAll("td:last-child")[0]?.innerText?.replaceAll(",",""),t=document.querySelector("#top-ratios li")?.getElementsByClassName("value")[0]?.getElementsByClassName("number")[0]?.innerText?.replaceAll(",","");else if("P/BV"===a)t=document.querySelectorAll("#top-ratios li")[1]?.getElementsByClassName("value")[0]?.getElementsByClassName("number")[0]?.innerText?.replaceAll(",",""),l=document.querySelectorAll("#top-ratios li")[4]?.getElementsByClassName("value")[0]?.getElementsByClassName("number")[0]?.innerText?.replaceAll(",",""),r=4,n=4,o=5;else if("EV/EBITDA"===a){let i=document.querySelectorAll("#top-ratios li");for(let s=0;s<=i.length;++s){let p=document.querySelectorAll("#top-ratios li")[s];if(p?.getElementsByClassName("name")?.[0]?.innerText==="Enterprise Value"){t=p?.getElementsByClassName("value")?.[0]?.innerText?.match(/[\d,]+/)[0].replace(/,/g,"");break}}l=Array.from(document.querySelectorAll("#profit-loss table.data-table tbody tr")).find(e=>e.cells[0].innerText.includes("Operating Profit"))?.querySelectorAll("td:last-child")[0]?.innerText?.replaceAll(",",""),r=15,n=15,o=18}c(),function e(){let a=`mc=${t}&e=${l}&dr=25&m1=${r}&m2=${n}&m3=${o}&d3=3`,i="calc_encryption_key_13624";if(a&&i&&window.CryptoJS){let c=CryptoJS.RC4.encrypt(a,i).toString(),s=`https://calc-fin.netlify.app/#/calculator/reverse-dcf?calcId=${encodeURIComponent(c)}`;window.open(s)}else console.error("Text and key are required, or CryptoJS not loaded!")}()})(a),e.appendChild(i)});let a=document.createElement("button");function i(t){e.contains(t.target)||c()}function c(){document.removeEventListener("click",i,!0),e.remove()}if(a.textContent="\xd7",a.style=`
    top:2px;
    right:5px;
    background:none;
    border:none;
    font-size:16px;
    cursor:pointer;
    color:#888;
  `,a.onclick=()=>c(),e.appendChild(a),document.body.appendChild(e),setTimeout(()=>{document.addEventListener("click",i,!0)},0),"undefined"==typeof CryptoJS){let s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js",document.head.appendChild(s)}};
