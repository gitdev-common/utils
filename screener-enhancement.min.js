!function(){if(window.calculationsApplied)return void alert("Calculations have already been applied.");const t=document.getElementById("profit-loss");if(!t)return void alert('Table with id "profit-loss" not found.');const e=t.querySelectorAll("thead th"),o=(e[e.length-1]?.textContent.trim().toLowerCase(),["Revenue","Sales","Operating Profit","Financing Profit","Net Profit"]),n=t.querySelectorAll("tbody tr"),l=[];n.forEach((t=>{const e=t.cells[0]?.textContent.trim();e&&o.some((t=>e.toLowerCase().startsWith(t.toLowerCase())))&&l.push(t)})),l.reverse();const r=document.getElementById("cash-flow");if(!r)return void alert('Table with id "cash-flow" not found.');const i=r.querySelectorAll("thead th"),s=Array.from(i).map((t=>t.textContent.trim().toLowerCase())),a=r.querySelector("tbody");l.forEach((t=>{const o=a.insertRow(0),n=t.cells[0]?.textContent.trim();o.insertCell().textContent=n,t.querySelectorAll("td").forEach(((t,n)=>{if(n>0){const l=e[n]?.textContent.trim().toLowerCase();if(-1!==s.indexOf(l)){o.insertCell().textContent=t.textContent.trim()}}}))})),l.forEach((t=>{const e=Array.from(t.cells).map((t=>parseFloat(t.textContent.replace(/[^0-9.-]+/g,""))));for(let o=2;o<e.length;o++){const n=e[o-1],l=e[o];if(isNaN(n)||isNaN(l)||0===n)continue;const r=(l-n)/Math.abs(n)*100,i=`${r.toFixed(2)}%`,s=t.cells[o],a=s.querySelector(".growth-popover");a&&a.remove();const c=document.createElement("div");c.className="growth-popover",c.textContent=i,c.style.position="absolute",c.style.background=r>=0?"#2e7d32":"#c62828",c.style.color="#fff",c.style.fontSize="12px",c.style.padding="2px 4px",c.style.borderRadius="4px",c.style.top="-10px",c.style.right="0px",c.style.pointerEvents="none",s.style.position="relative",s.appendChild(c)}}));i.forEach(((t,e)=>{if(e>0&&!t.querySelector('input[type="checkbox"]')){const e=document.createElement("input");e.type="checkbox",e.style.marginRight="5px",t.prepend(e)}}));const c=document.createElement("button");c.id="sum-button",c.textContent="Sum Selected Columns",c.style.marginBottom="10px",c.style.marginTop="10px",c.style.padding="8px 12px",c.style.background="#1976d2",c.style.color="#fff",c.style.border="none",c.style.borderRadius="4px",c.style.cursor="pointer",c.style.float="right",c.addEventListener("click",(()=>{const t=["Sales","Revenue","Operating Profit","Financing Profit","Net Profit","Cash from Operating Activity"],e=[],o=[];if(i.forEach(((t,n)=>{if(n>0){const l=t.querySelector('input[type="checkbox"]');l&&l.checked&&(e.push(n),o.push(t.textContent.trim()))}})),0===e.length)return void alert("No headers selected!");const n=a.querySelectorAll("tr"),l=[];if(n.forEach((o=>{const n=o.cells[0]?.textContent.trim()?.replace("+","");if(t.some((t=>n.toLowerCase().startsWith(t.toLowerCase())))){let t=0;e.forEach((e=>{const n=o.cells[e];if(n){const e=parseFloat(n.textContent.replace(/[^0-9.-]+/g,""));isNaN(e)||(t+=e)}})),l.push({label:n,total:t.toFixed()})}})),0===l.length)return void alert("No matching rows found.");const r=l?.find((t=>t.label?.startsWith("Operating Profit")))??l?.find((t=>t.label?.startsWith("Financing Profit"))),s=l?.find((t=>t.label?.startsWith("Net Profit"))),c=l?.find((t=>t.label?.startsWith("Cash from Operating Activity"))),d=(c?.total/s?.total*100).toFixed(2),p=(c?.total/r?.total*100).toFixed(2);d&&l.push({label:"CFO/PAT",total:d+" %"}),p&&l.push({label:"CFO/EBITDA",total:p+" %"});let y='<div style="display: grid; grid-template-columns: 1fr auto; row-gap: 12px">';l.forEach(((t,e)=>{y+=`\n        <div style="font-weight: 500; padding: 4px 2px; background: ${e%2==0?"rgb(248,248,255)":void 0}">${t.label}</div>\n        <div style="text-align: right; padding: 4px 2px; background: ${e%2==0?"rgb(248,248,255)":void 0}">${t.total}</div>\n      `})),y+="</div>";(({title:t="Modal Title",content:e="This is the modal content.",isHTML:o=!1}={})=>{const n=document.createElement("div");n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100vw",n.style.height="100vh",n.style.backgroundColor="rgba(0, 0, 0, 0.5)",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.zIndex="9999";const l=document.createElement("div");l.style.backgroundColor="#fff",l.style.padding="20px",l.style.borderRadius="8px",l.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.3)",l.style.maxWidth="400px",l.style.width="100%",l.style.position="relative";const r=document.createElement("h3");r.textContent=t;const i=document.createElement("div");o?i.innerHTML=e:i.textContent=e;const s=document.createElement("button");s.textContent="Ã—",s.style.position="absolute",s.style.top="10px",s.style.right="10px",s.style.border="none",s.style.background="transparent",s.style.fontSize="32px",s.style.cursor="pointer",s.onclick=()=>document.body.removeChild(n),l.appendChild(s),l.appendChild(r),l.appendChild(i),n.appendChild(l),document.body.appendChild(n)})({title:"Cash flows",content:`<div style="margin-bottom: 32px">${o?.join(", ")}</div>`+y,isHTML:!0})})),r.parentElement.insertBefore(c,r),window.calculationsApplied=!0}();
